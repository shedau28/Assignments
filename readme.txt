from django.shortcuts import render
import pdfkit
import subprocess
import os
import glob
import PyPDF2
import datetime

# Create your views here.


def certi_page(request):

    # names = ['Alice', 'Bob', 'Charlie']

    names = ['Heather Moss', 'Anthony Smith', 'Tracy Daniels', 'Miguel Myers', 'Heather Hicks', 'Kelly Murphy', 'Margaret Smith', 'Jean Mccoy', 'Anthony Wise', 'Diane Jimenez', 'Christy Green', 'Jonathan Nguyen', 'Katie Kelley', 'Randall Henderson', 'Jerry Williams', 'Stacey Hawkins', 'Scott Baker', 'Taylor Clark', 'Steven Lewis', 'Audrey West', 'William Graham', 'Eric Cervantes', 'Jeffrey James', 'Patricia Chan', 'Joshua Peters', 'Ronald Maxwell', 'Melissa Reyes', 'Brian Harris', 'Jennifer Clayton', 'Bryan Perry', 'Terry Short', 'Mackenzie Martinez', 'Alex Velazquez', 'Jeffrey Smith', 'Amanda Brown', 'Anthony Allen', 'Anna Anderson', 'Jennifer Ross', 'Martha Rogers', 'Michael Gordon', 'Lydia Maxwell', 'Sergio Schmidt', 'Diana Romero', 'Amy Nash', 'Ashley Newman', 'Heather Becker', 'Patrick Stewart', 'Kari Esparza', 'Douglas Hernandez PhD', 'Destiny Garcia', 'Eric Collins', 'Joseph Robbins', 'Alexandria Moore', 'Julie Shea', 'Ashley Vazquez', 'Connie Beard', 'Richard Smith', 'Michael Williams', 'Denise Burns', 'Colton Martin', 'Gregory Friedman', 'Deborah Stephens', 'Alejandro Stevens', 'Jamie Tucker DDS', 'Eric Christensen', 'Michael Garcia', 'James Nelson', 'Stephanie Osborne', 'Carolyn Hoffman', 'Stephanie Martinez', 'Joseph Summers', 'Sandra Finley', 'Morgan Mcclain', 'Megan Hanson', 'Ricardo Jenkins', 'Ryan Davidson', 'Alicia Harris', 'Scott Vaughan', 'Misty Henderson', 'Michael Park', 'Jonathan Huerta', 'Michael Gardner', 'Elizabeth Mejia', 'Nicholas Baker', 'Roger Harris', 'Gabriel Barnett', 'Jonathan Frederick', 'Kelly Reed', 'Meghan Eaton', 'Russell Gibson', 'Christopher Hawkins', 'Melissa Thomas', 'Kelly Hernandez', 'Alexis Ramirez', 'Phillip Hood', 'Jason Mccullough', 'Virginia Carlson', 'Eugene Pace', 'John Smith', 'Monica Orozco', 'Thomas Rogers', 'Mrs. Gina Schwartz PhD', 'Regina Williams', 'Kevin Scott', 'Lindsey Walsh', 'Cynthia Coleman', 'Robin Avila', 'Dawn Rosario', 'Dawn Johnson', 'Jasmin Gray', 'Jason Brown', 'Paul Gray', 'Catherine Espinoza', 'Nancy Underwood', 'Stephanie Frazier', 'Matthew Gonzalez', 'Melanie Washington', 'Shelley Harris', 'Stephen Solomon', 'Cory Smith', 'Alyssa Bates', 'Brent Rodriguez', 'Joel Horton', 'Christopher Lewis', 'Matthew Sharp', 'Kathryn Ford', 'Jacob Shaw', 'Jessica Scott', 'Michelle Buchanan', 'Jessica Smith', 'Andre Jimenez', 'Katherine Espinoza', 'Richard Wang', 'Brandon Booth', 'William Davis', 'Angela Stuart', 'Patricia Rodriguez', 'Michele Rice', 'Shelia Contreras', 'John Williams', 'Kristin Barton', 'Kimberly Wood', 'Melissa Anderson', 'Courtney Gay', 'Amanda Moore', 'Michelle Shaw', 'Karen Lee', 'Hannah Camacho', 'Michael Miller', 'Johnny Bush', 'Gloria Hines', 'Kristin Simpson', 'Anthony Bridges', 'Johnathan Lara', 'Rhonda Allen', 'Douglas Thompson', 'Tina Mercado', 'Colton Hernandez', 'Ronald Simon', 'Nicole Reyes', 'Kristie Hart', 'Steven Davis', 'Theodore Williams', 'James Graham', 'Brooke Rollins', 'Andrew Horton', 'Nathaniel Bell', 'Mark Nelson', 'Jason Perez', 'Lisa Lewis', 'Lisa Walker', 'Paul Atkins', 'Matthew Martin', 'Matthew Carter', 'Dawn Caldwell', 'Brett Schwartz', 'Michelle Cain', 'Erik Kim', 'Timothy Murray', 'Ashley Gillespie', 'Hannah Davis', 'Cheyenne Garcia', 'Megan Henderson MD', 'Stephanie Arroyo', 'Jennifer Davis', 'Angela Simmons', 'Dorothy Brown', 'Rhonda Hull', 'Keith Blackwell', 'Alice Moore', 'Michael Hall', 'Terry Rose', 'Andrew Martin', 'Sheila Freeman', 'Craig Clark', 'Thomas Zamora', 'Samuel Hodges', 'Darlene Stuart', 'Maria Edwards', 'Katherine Cortez', 'Erica Wise', 'Jacqueline Thomas', 'Caroline Graham', 'Jessica Mcgee', 'Denise Jackson', 'Angela Porter', 'Lori Cooke', 'Kimberly Griffin', 'Tyler Jensen', 'Robert Medina', 'Jenna Schroeder', 'Beth Freeman', 'Leah Gregory', 'Laura Patton', 'Jose Moore', 'Dana Crosby', 'Julie Ross', 'Jennifer Quinn', 'James Meyers', 'Kimberly Olson', 'Ann Mckinney', 'Joseph Contreras', 'Jessica Fields', 'Rebecca Burke', 'Roberta Singh', 'Dakota Garcia', 'Katie Simmons', 'Debra Smith', 'John Ramirez', 'Alicia Cooper', 'Madeline Bullock', 'Lynn Lyons', 'Andrew Roberts', 'Phillip Garcia', 'Jacob Morales PhD', 'Susan Rogers', 'Carolyn Burke', 'Kimberly Spencer', 'Andrea Garcia', 'Matthew Terry', 'Mary Petersen', 'John Martin', 'Stephanie Stein', 'Anthony Taylor', 'Candace Horton', 'Kathryn Wang', 'Roy Dorsey', 'Gregory Sosa', 'Nancy Lewis', 'Misty Smith', 'Mary Li', 'Zachary Anderson', 'Edward Todd', 'Jessica Green', 'Steven Chan', 'Dylan Payne', 'Samantha Lang', 'Catherine Navarro', 'Sierra Hicks', 'Ms. Melissa Horton', 'Jessica Brown PhD', 'David Reynolds', 'Elizabeth Marshall', 'Donald Richardson', 'Amy Smith', 'Reginald Kent', 'Andrew Kelley', 'Kimberly Sherman', 'Destiny West', 'Bradley Garza', 'Mathew Hampton', 'Dominic Mills', 'Jean Faulkner', 'Kimberly Brown', 'Rebecca Downs', 'Brian Smith', 'Pamela Davis', 'Lisa Ryan', 'Sheri Acosta', 'Michael Daniels', 'Amanda Jones', 'Tammy Burke', 'Laura Jarvis', 'Richard Griffin', 'Christopher Young', 'Jessica Thornton', 'Zachary Brown', 'Beth Ball', 'Harry Lane', 'Lee Green', 'Justin Franco', 'Brenda Riley', 'Richard Miller', 'Leslie Perez', 'Nicole Weaver', 'Michael Gallegos', 'Danielle Ford', 'Jessica West', 'Katherine Fowler', 'Charles Holmes', 'Robert Wall', 'Laura Frye', 'Seth Chang', 'Mary Hull', 'Omar Evans', 'Samantha Ayers', 'Melissa Rice', 'Jennifer Hobbs', 'Edward Mcintyre', 'Nicholas Santos', 'Kimberly Yoder', 'Jamie Moore', 'Christine Miller', 'Nicole Mays', 'Billy Novak', 'Dr. Carla Ball', 'Elizabeth Jennings', 'Chloe Flowers', 'Jackson Torres', 'Dr. Susan Macias', 'Michael Meyer', 'Gregory Garcia', 'Leslie Smith', 'Kevin Wheeler', 'Cody Burke', 'Christine Robinson', 'Jennifer Miller', 'Frances Coleman', 'Kevin Jones', 'Jacob Haney', 'Peter Nelson', 'Jeffery Stuart', 'Douglas Mills', 'Marcus Summers', 'Mark Buchanan MD', 'Tammy Ochoa', 'Andre Holland', 'Jamie Johnson', 'Joseph Butler', 'John Brown', 'Miguel Smith', 'Linda Pennington', 'Joseph Carpenter', 'Jeffrey Whitehead', 'Tyler Evans', 'Barry Pope', 'Albert Webb', 'Terry Phillips', 'Eric Clark', 'Margaret Smith', 'Calvin Williams', 'James Hernandez', 'Suzanne Hart', 'Rachel Martinez', 'Dana Brandt', 'Diana James', 'Barbara Kim', 'Robert Johnson', 'Kerry Wilson', 'Aaron Lamb', 'Jesus Matthews', 'Elizabeth Williamson', 'Brian Barker', 'Kerri Hall', 'Keith Carpenter', 'Carlos Evans', 'Alexandra Walker', 'Anthony Flynn', 'David Richards', 'Anthony Buckley', 'Daniel Mayo', 'Anne George', 'Jonathan Williams', 'Krista Chan', 'Rachel Douglas', 'Zachary Solis', 'Alicia Morrison', 'Joel Brown', 'Cory Perry', 'Robert Bond', 'Alicia Mcmahon', 'John Ramirez', 'Jeremiah Wilson', 'Lisa Moore', 'Michael Day', 'Mr. Brian Horton MD', 'Gregory Maldonado', 'Katherine Leonard', 'Jeffrey Miller', 'Alison Lang', 'David Olson', 'Anna Garcia', 'Timothy Gallagher', 'Angel Schwartz', 'Kyle Sherman', 'Caitlin Shields', 'Bryan Steele', 'Amanda Haley', 'Todd Walker', 'Holly Weaver', 'Michelle Norris', 'Samuel Griffin', 'Christopher Torres', 'Mrs. Jennifer Macias MD', 'William Anderson', 'Kenneth Jenkins', 'Travis Parrish', 'Mathew Edwards', 'Dr. Angela Harper', 'Stephen Mills', 'Abigail Walker', 'Christopher Johnson', 'Louis Raymond', 'Donna Rice', 'Jessica Shields', 'Meghan Howard', 'Ruben Lynn', 'Michelle Johnson', 'Mr. Jeffrey Powell', 'Mitchell Stewart', 'Daniel Edwards', 'Michelle Garrett', 'Ashlee Stewart', 'Grace Wolf', 'Judy Hall', 'John Lawrence', 'Todd Schultz', 'Joyce Gates', 'Kimberly Green', 'Mark Jimenez', 'Alice Holland', 'Deborah Burnett', 'Christopher Mason', 'Zachary Campbell', 'Erica Nolan', 'Ryan Logan', 'April Shah', 'Edward Mccann', 'Kristin Martinez', 'Latoya Welch', 'Kayla Baker', 'Juan Grant', 'Andrea Palmer', 'Dawn Thomas', 'Sarah Hernandez', 'Erin Glover', 'Jessica Rojas', 'Michael Flores', 'Daniel Craig', 'Eric Lambert', 'Nicholas Chapman', 'Billy Floyd', 'Nancy Bradshaw', 'Ashley House', 'Willie Castillo', 'John Padilla', 'Kevin King', 'Daniel Wright', 'Ricky Moore', 'Andre Mosley', 'Rebecca Bartlett', 'Paige Spears', 'Matthew Frank', 'William Pierce', 'Robert Pace', 'Nicholas Austin', 'Todd Dixon', 'Madison Hart', 'Meghan Wright', 'Kenneth Carter', 'Joseph Thomas', 'Joshua Roberts', 'Jill Richardson', 'Kevin Dawson', 'Brian Reed', 'Terri Gomez', 'Joshua Baxter', 'Jared Washington', 'Jacqueline Gutierrez', 'Anthony Jackson', 'Jamie White', 'Mark Bentley', 'Christine Cannon', 'Melinda Jenkins', 'Kimberly Williams', 'Joshua Rice', 'Joseph Taylor', 'Jamie Meyer', 'Ryan King', 'Allison Williams MD', 'Breanna Cruz', 'Randall Brown MD', 'Michael Rodriguez', 'Glenda Jackson', 'Sylvia Schneider', 'Jordan Jenkins', 'Timothy Vasquez', 'Kristen Martinez', 'Renee Black MD', 'Courtney Thompson', 'Robert Frazier', 'Heather Cobb', 'Adam Schultz', 'James Osborne', 'Brooke Andrews', 'Julie Durham', 'Michael Reid', 'Christine Padilla', 'Diane Ortiz', 'Leslie Gonzalez', 'Courtney Cooper', 'Julia Baldwin', 'Daniel Snyder', 'Natalie Robertson', 'Mrs. Rebecca Keith', 'Rachael Rogers', 'Holly Haynes', 'Richard Cole', 'Jonathan Johnson', 'Amanda Conrad', 'Michael Brown', 'Adam Johns', 'Devon Miranda PhD', 'Jill Hernandez', 'Steven Haas', 'Michelle Cook', 'Amber Tyler', 'Joseph Day', 'Charles Price', 'Brenda Arias', 'Jared Harrison', 'Casey Schneider', 'Eric Davis', 'Caleb Downs', 'Andrew Newton', 'Matthew Stewart', 'Andrea Green', 'Katherine Hawkins', 'Katelyn Doyle', 'Richard Nguyen', 'Brian Mitchell', 'Tommy Norton', 'James Williams', 'Corey Vance', 'Christopher Young', 'Daniel Jackson', 'Sandra Humphrey', 'Robert Harrison', 'Taylor Rios', 'John Jenkins', 'Ryan Gonzales', 'Devon Moreno Jr.', 'Sandra Ramirez', 'Whitney Davis', 'Frank Kennedy', 'Jamie Williams', 'Melissa Bennett', 'Laura Lara', 'Mark Lewis', 'Jonathan Alexander', 'Sharon Griffin', 'Kimberly Patel', 'Grace Foster', 'Clarence Warner', 'Toni Finley', 'Lacey Griffin', 'Amy Gonzales', 'Donald Beck', 'Robert Robles', 'Sean Valdez', 'Wayne Odom', 'Frank Chan', 'Joseph Guzman', 'Angela Espinoza', 'Brandon Mendez', 'Adam Black', 'Marissa Daniels', 'Emma Mora', 'Dana Spence', 'Rachel Henry', 'Joshua Smith', 'Raymond Ortiz', 'Sandra Perkins', 'Robert Williamson', 'Joanne Gray', 'Nancy Barnett', 'Matthew Glass', 'Bonnie Watson', 'Samantha Foster', 'Wayne Romero', 'Joseph Haynes', 'Donna Hudson', 'Aaron Morales', 'Jason Navarro', 'Daniel Williams', 'Joshua Evans', 'Sarah Taylor', 'Amanda Johnson', 'Warren Martin', 'Todd Martin', 'David Hudson DDS', 'Joseph Hines', 'Stephanie Freeman', 'Crystal Cooper', 'Keith Sherman', 'Mr. Tony James', 'Erica Adams MD', 'Jacob Vincent', 'Bethany Ortega', 'Teresa Rivera', 'Jennifer Zamora', 'Maria Brooks', 'Ryan Phillips', 'Mark Malone', 'Pamela Saunders', 'Lauren Aguirre', 'Melody Moore', 'Sharon Stanley', 'Reginald Delgado', 'Rebekah Stephens', 'Jose Mcpherson', 'Margaret Mullins', 'Katherine Miller', 'David Kennedy', 'Robert Vasquez DDS', 'Bryan Warren', 'Jennifer Le', 'Willie Williams', 'Melissa Mendoza', 'James Aguilar', 'Mark Walls', 'Susan Bush', 'Wendy Aguirre', 'Ethan Flores', 'James Jones', 'Heidi Hutchinson', 'Allison Taylor', 'Randy Johnson', 'Brian Murray', 'Daniel Williams', 'Scott Gregory', 'Cory Calhoun', 'Kimberly Curtis', 'Timothy Moss', 'Jacqueline Cook', 'Alfred Brennan IV', 'Michelle Barker', 'Jennifer Jensen', 'James Horton', 'John Davis', 'Michael Tran', 'Sean Reese', 'Joseph Reyes', 'Robert Brown', 'David Williams', 'Nicholas Shaw', 'Kathy Day', 'Joseph Powell', 'Jordan Wilson', 'Lisa Wagner', 'Jennifer Brennan', 'Donald Blackburn', 'Wesley Lee', 'Mr. John Gomez', 'Travis Roberts', 'Alexander Koch', 'Roy Saunders', 'Michelle Ford', 'Thomas Bennett', 'Manuel Harris', 'Justin White', 'William Meadows', 'Martha Garcia', 'Kelly Jackson', 'Christy Yang', 'Kathy Peterson', 'Stephanie Roberts', 'Larry Stewart', 'Adrienne Porter', 'Barbara Lambert', 'Cynthia Knight', 'Andres Perez', 'Bradley Jackson', 'Grant Glover', 'Morgan Smith', 'Kathy Jenkins', 'Aaron Carr', 'David King', 'Kimberly Brooks', 'Hannah Young', 'Brooke Vazquez', 'Nancy Chase', 'Audrey Robbins', 'Julie Lewis', 'Kelly Young', 'Nathaniel Ferguson', 'Tiffany Lee', 'Julia Harris', 'Jerry Myers', 'Jeffrey Buck', 'Joe Smith', 'James Flores', 'Jonathan Wong', 'Brian Davis', 'Joel Floyd', 'Shawn Martin', 'Frank Pena', 'Gregory Walker', 'Brian Munoz', 'Shannon Jenkins', 'Neil Good', 'Billy Jackson', 'Nicole Roberts', 'Johnny Grant', 'Aaron Harding', 'Tanya Vance', 'Kyle Brown', 'Angel Herrera', 'James Mueller', 'Mr. Shawn Munoz Jr.', 'Austin Wyatt', 'Shannon Lopez', 'Mike Hall', 'Brandon Bailey', 'Richard Turner', 'Katherine Kennedy', 'Michael Miller', 'Ashley Smith', 'Kristi Myers', 'Jason Noble', 'Roger Richmond', 'Jacob Austin', 'Mr. Tyler Barrett', 'Derrick Burns', 'Kristen Potter', 'Marie Cobb', 'Brenda Weaver', 'Elizabeth Fuller', 'Joseph Smith', 'Karen Leach', 'Todd Morris', 'Amanda Williams', 'Sarah Gray', 'Mark Mathis', 'Jacob Swanson', 'Dr. Sarah White', 'Casey Swanson', 'Richard Floyd', 'Stephanie Hoffman', 'Kathleen Taylor', 'Deborah Zuniga', 'Eduardo Massey', 'Katherine Wright', 'Benjamin Thompson', 'Elijah Jensen', 'Claire Henderson', 'Elizabeth Russell', 'Erica Nelson', 'Chad Jordan', 'Heather Myers', 'Crystal Miller', 'Leslie Santos', 'Jacqueline Hunter', 'Dalton Bender', 'Karen Petty', 'Olivia Ware', 'Micheal Summers', 'Kimberly Moore', 'Garrett White', 'David Dickson', 'Charles Francis', 'Kelly Harrison', 'Jennifer Blankenship', 'Jerry Thompson', 'Brian Baker', 'Ruben Allison', 'Courtney Watson', 'Kevin Cobb', 'Walter Johnson', 'Sean Valencia', 'Brian Townsend II', 'Tanya Jordan', 'Kristen Keller', 'Veronica Alexander', 'Stephen Andrews', 'Anthony Hebert', 'Paul Wheeler', 'Steven Bush', 'Edward Waller', 'Jeffery Simpson', 'Richard Hartman', 'Amy Martinez', 'Jill Reid', 'Sarah Marks', 'Michael Davis', 'Michele Sanchez', 'Joseph Wade', 'Thomas Morton', 'Brenda Williams', 'Andrew Shaffer', 'Matthew Robinson', 'Robert Perkins', 'Heidi Kelly', 'Felicia Fields', 'Bethany Stewart', 'Anthony Arnold', 'Robert Thomas', 'Anthony Deleon', 'Rodney Walker', 'Laura Coleman', 'Brian Schneider', 'Lynn Clark', 'Christopher Salazar', 'Laura King', 'Mr. Matthew George', 'Tanya Fisher', 'Cory Mason', 'Amanda Evans', 'Tina Jones', 'Richard Mckinney', 'Kristopher Saunders', 'James Rosales', 'Edward Clark', 'Dr. Kristin Wallace', 'Ryan Wolf', 'Kara Webster', 'Matthew Martin', 'Charles Acosta', 'Kelsey Jones', 'Mary Howell', 'Andrew Bailey', 'Anthony Stark', 'Faith Davis', 'David Savage', 'Jeffrey Cochran', 'Teresa Hunt', 'Robert Parker', 'John Reed', 'David Griffin', 'Elizabeth Gardner', 'Nichole Gonzalez', 'Jason Campbell', 'Michael Fuller PhD', 'Austin Lee', 'Lisa Diaz', 'April Taylor', 'Allison Wright', 'Jacob Castro', 'Thomas Hale', 'Dylan Boyle', 'Daniel Ingram', 'Jonathan Greer', 'Thomas Harrell', 'Donald Barron', 'Michelle Bryant', 'Daniel Campbell', 'Michael Hahn', 'Traci Kent', 'Michael Monroe', 'Matthew Richmond', 'Benjamin Cannon', 'Tonya Blackwell', 'Peter Howell', 'Cassandra Robinson', 'Nathaniel Henry', 'Amber Ramirez', 'Charles Snyder', 'Jodi Espinoza', 'Brian Williams', 'Jason Peterson', 'Jason Flynn', 'Robert Smith', 'Jeremy Hodges', 'Crystal Hooper', 'Gary Ramirez', 'Jeremiah Miller PhD', 'Luke Orozco', 'Brett Thompson', 'Lisa Flynn', 'Tiffany Crawford', 'April Walton', 'Collin Hill', 'Mr. Kyle Boone', 'Heather Wright', 'Samantha Brown', 'Jillian Brown', 'Nicholas Burton', 'Raymond James', 'Derek Snyder', 'John Werner', 'Bianca Mcdonald', 'Jennifer Atkinson', 'Katherine Moran', 'Brandon Williams', 'Alyssa Wright', 'Thomas Harris', 'Stacey Meza', 'Diane Gay', 'Juan Fields', 'Amber Pruitt', 'Sherry Holloway', 'Elizabeth Smith', 'Tara Rodriguez', 'Nathaniel Winters', 'Rebecca Rios', 'George Maxwell', 'Sara Fitzgerald', 'Melinda Garcia', 'Ashley Mendoza', 'Erik Vargas', 'Darius Stewart', 'Melinda Brown', 'Nicole Richmond', 'Sarah Fry', 'Samuel Campbell', 'Ashley Hughes', 'William Fuentes', 'Pamela Black', 'Melissa Sullivan', 'Christopher Wright', 'Susan Owen', 'Douglas Clark', 'Richard Mendez', 'Jessica York', 'Christopher Clark', 'Terry Wang', 'Jim Thompson', 'Carol Burton', 'Kelly Flores', 'Matthew Lewis', 'David Fitzgerald', 'Adam Schroeder', 'Heather Johnson', 'Matthew Bradford', 'Erin Ryan', 'Janice Lewis', 'Cristian Huffman', 'Adam Dean', 'Anthony Rodriguez', 'Joseph Friedman', 'Ryan Harris', 'Jason Reese', 'Johnathan Benson', 'Parker Cooper', 'Maria Rivera', 'Andrew Hill', 'Candice Fletcher MD', 'Christina Adams', 'Anne Ortega', 'Gary Martin', 'Brent Walker', 'Wesley Stone', 'Lawrence Yates', 'Jessica Evans', 'Karla Gomez', 'Linda Walker', 'Lisa Gaines', 'April Meyers', 'Vincent Burke', 'Jose Landry', 'Natalie Anderson', 'Louis Garcia', 'Emily Walton', 'Jerry Rivera', 'Keith Murray', 'Nicholas Baker', 'Maurice Burke', 'Mark Giles', 'Eric Gray', 'Rebecca Spencer', 'Drew Rodgers', 'Scott Santana', 'Jon Parks', 'Roberto Morgan', 'Michael Turner', 'Catherine Hahn', 'Bethany Cox', 'Dakota Smith', 'Darren Cox', 'Meghan Miller', 'Tristan Sheppard', 'Jason Martinez', 'Kristen Singleton', 'Jennifer Martin', 'Steve Young', 'Jeanne Lee', 'Michelle Gray', 'Lauren Ray', 'Terry Henderson', 'Aimee Park', 'Linda Miller', 'Patricia Schmidt', 'Melinda Cook', 'Leslie Morris', 'Toni Harris', 'Janet Cobb', 'Ashley Phillips', 'Anthony Owen', 'Ian Moore', 'Jeremy Cooper']
    print(len(names))

    starttime = datetime.datetime.now()
    for name in names:

        wkhtmltopdf='C:/Program Files/wkhtmltopdf/bin/wkhtmltopdf.exe'
        config = pdfkit.configuration(wkhtmltopdf='C:/Program Files/wkhtmltopdf/bin/wkhtmltopdf.exe')
        template_path = r"D:/Django Projects/Email Sender Using Django/templates/Certificate.html"
        with open(template_path, 'r') as f:
            template = f.read()

        html = template.replace('{{name}}', name)
     
        p = subprocess.Popen([wkhtmltopdf, '-', f'SAMPLE{name}.pdf'], stdin=subprocess.PIPE)
        p.communicate(html.encode())

    endtime = datetime.datetime.now()

    sec_start = datetime.datetime.now()
    pdf_dir = './'

    # Set the batch size (number of PDFs to merge in each batch)
    batch_size = len(names)

    # Get a list of all the PDF files in the directory
    pdf_files = glob.glob(os.path.join(pdf_dir, '*.pdf'))

    # Loop through the PDF files in batches and merge them
    for i in range(0, len(pdf_files), batch_size):
        # Create a new PDF writer object
        pdf_writer = PyPDF2.PdfWriter()

        # Loop through the PDF files in the batch and add them to the writer
        for j in range(i, min(i+batch_size, len(pdf_files))):
            pdf_file = open(pdf_files[j], 'rb')
            pdf_reader = PyPDF2.PdfReader(pdf_file)

            for k in range(len(pdf_reader.pages)):
                # page = pdf_reader.getPage(k)
                page = pdf_reader.pages[k]
                pdf_writer.add_page(page)

            pdf_file.close()

        # Save the merged PDF file for the batch
        output_file = open('merged_batch_{}.pdf'.format(i//batch_size+1), 'wb')
        pdf_writer.write(output_file)
        output_file.close()

    sec_end = datetime.datetime.now()

    print("TIMINGS", starttime)
    print("TIMINGS", endtime)
    print("TIMINGS", sec_start)
    print("TIMINGS", sec_end)


    # Set the path to the directory containing the PDF files
    pdf_dir = './'

    # Get a list of all the PDF files in the directory that start with 'SAMPLE'
    pdf_files = glob.glob(os.path.join(pdf_dir, 'SAMPLE*.pdf'))

    # Loop through the PDF files and delete them
    for pdf_file in pdf_files:
        os.remove(pdf_file)

    print("====================END=====================")

    return render(request, "Certificate.html")
